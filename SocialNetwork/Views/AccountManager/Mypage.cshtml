@model SocialNetwork.ViewModels.Account.UserViewModel;
@{
    ViewData["Title"] = "My page";
}

<div class="main-container">
    <div class="user-container">
        <h2>@Model._user.FirstName @Model._user.LastName</h2>
        <div>
            <img src="@Model._user.Image" />
        </div>
        @* <p>@Model._user.FirstName @Model._user.LastName</p> *@

        <div class="friens-container">
            <ul>
                <li><img src="images/person-unknown.svg" />Первый друг</li>
                <li><img src="images/person-unknown.svg" />Второй друг</li>
                <li><img src="images/person-unknown.svg" />Третий друг</li>
            </ul>
        </div>
    </div>

    <div class="content-container">
        <h2>Моя лента</h2>

        <div class="card-body">
            <h5 class="card-title">Напишите сообщение</h5>
            <textarea id="messageInput" class="form-control" rows="3" placeholder="Введите сообщение..."></textarea>
            <button id="sendMessage" class="btn btn-primary">Отправить</button>
        </div>
        
        <div id="messageSection" class="mt-4">
            <!-- Здесь будет отображаться сообщение -->
        </div>
    </div>

</div>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('sendMessage').addEventListener('click', function() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            if (message === "") return;

            const messageHtml = `
                <div class="card">
                    <div class="card-body">
                    <div class="card-subtitle">
                        <h6 class="card-subtitle-author">@Model._user.GetFullName()</h6>
                        <h6 class="card-subtitle-date">${new Date().toLocaleString()}</h6>
                        </div>
                        <p class="card-text">${message}</p>
                        <button class="btn btn-sm btn-secondary addComment">Добавить комментарий</button>
                        <div class="comment-section"></div>
                    </div>
                </div>`;

            const messageSection = document.getElementById('messageSection');
            messageSection.insertAdjacentHTML('afterbegin', messageHtml);
            messageInput.value = ''; // Очистить поле
        });

        // Обработчик для добавления комментария
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('addComment')) {
                const commentInput = `
                    <textarea class="form-control commentText mt-2" rows="2" placeholder="Введите комментарий..."></textarea>
                    <button class="btn btn-sm btn-success submitComment mt-1">Добавить</button>`;

                const commentSection = e.target.nextElementSibling;
                commentSection.innerHTML = commentInput;
            }
        });

        // Обработчик для отправки комментария
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('submitComment')) {
                const textarea = e.target.previousElementSibling;
                const comment = textarea.value.trim();
                if (comment === "") return;

                const commentHtml = `<div class="alert alert-light mt-2 border">${comment}</div>`;
                const commentSection = e.target.parentElement;

                // Добавляем комментарий
                commentSection.insertAdjacentHTML('beforeend', commentHtml);

                // Удаляем поле ввода и кнопку
                textarea.remove();
                e.target.remove();
            }
        });
    });
</script>
